<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: mod.cart.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: mod.cart.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Cart
 * @Author Curtis M. Janczak
 * @Version 0.1
 * @Namespace CART
 * @Param {Object} window
 * @Param {Object} document
 */
 var CART = ( function ( window, document, PRODUCTS ) {

 	/**
 	 * Params
 	 * Private
 	 * @Memberof CART
 	 * @Param {Boolean} inited
 	 * @Param items
 	 * @Param subtotal
 	 * @Param {Object} storage
 	 * @Param {Object} _options
 	 */
 	var inited = false;
 	var items=0, subtotal=0;
	var storage = window.storage;
	var _options = {
		dataPath: "/data/",
		itemsEleId: "items",
		subtotalEleId: "subtotal"
	};

	/**
	 * Initialize Cart
	 * @Memberof CART
	 * @Private
	 * @Function init
	 */
	function _init(){
		if(!inited){
			storage.clear();

			setCart();
			
			inited = true;
		}
	}

	/**
	 * Setup default values to local storage and update cart
	 * @Memberof CART
	 * @Private
	 * @Function setCart
	 */
	function setCart(){
		storage.set({ 
			items: 0, 
			subtotal: 0
		}, function(){
			updateCart();
		});
	}

	/**
	 * Add Item to Cart
	 * @Memberof CART
	 * @Private
	 * @Function _addItem
	 * @Param {integer} id
	 */
	function _addItem( id ){

		var url = _options.dataPath + "product-" + id + ".json";

		// query data and get product info
		$.getJSON( url, function( data ){
			if(console) console.log( "Product: " + JSON.stringify( data ) );
		
			// get price
			var price = data.properties.price;
			var quantity = Number(document.getElementById( "qty-" + id ).value);

			// increment items and calculate new subtotal
			items = Number(items) + quantity;
			subtotal = subtotal + (quantity * price);

			// store new values in local storage
			storage.set({
				items: items, 		// increment number of items in cart
				subtotal: subtotal 	// update value of subtotal
			}, function(err) {
				updateCart();		// update cart
			});
		});
	}

	/**
	 * Count items in Cart
	 * @Memberof CART
	 * @Private
	 * @Function _countItems
	 * @Param {Function} callback
	 * @Example countItems( function(){alert( items )} );
	 */
	function _countItems( callback ){
		storage('items', function(err, val){
			items = val

			// return items to callback function if defined
			if( callback ) callback( items );
		});
	}

	/**
	 * Get Cart and update DOM
	 * @Memberof CART
	 * @Private
	 * @Function updateCart
	 */
	function updateCart(){
		storage(['items', 'subtotal'], function(err, col){
			//console.log("Cart Collection - " + JSON.stringify(col));

			//items = col[0];
			//subtotal = col[1];

			if(console) console.log("Items in Cart: " + items);
			if(console) console.log("Subtotal of Cart: " + subtotal);
			
			// update DOM Here
			document.getElementById( _options.itemsEleId ).innerHTML = items;
			document.getElementById( _options.subtotalEleId ).value = "$" + subtotal.toFixed(2);

			// reset default quantity input fields of products
			PRODUCTS.updateProducts();
		});
	}

	/**
	 * Reveal public functions
	 * @Memberof CART
	 * @Public
	 * @Returns {Function} init()
	 * @Returns {Function} addItem()
	 * @Returns {Function} countItems()
	 */
	return {
		init: _init,
		addItem: _addItem,
		countItems: _countItems
	};

}( CART || window, document, PRODUCTS ));</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="CART.html">CART</a></li><li><a href="MOD_INTERACT.html">MOD_INTERACT</a></li><li><a href="Products.html">Products</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> on Wed Aug 19 2015 13:13:01 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
